---
version: 2
interactions:
- id: 0
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 259
    host: api.osv.dev
    body: |
      {
        "queries": [
          {
            "package": {
              "name": "github.com/gogo/protobuf",
              "ecosystem": "Go"
            },
            "version": "1.3.1"
          },
          {
            "package": {
              "name": "github.com/ipfs/go-bitfield",
              "ecosystem": "Go"
            },
            "version": "1.0.0"
          },
          {
            "package": {
              "name": "golang.org/x/image",
              "ecosystem": "Go"
            },
            "version": "0.4.0"
          }
        ]
      }
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_CallAnalysis/Run_with_govulncheck
    url: https://api.osv.dev/v1/querybatch
    method: POST
- id: 1
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 96
    host: api.osv.dev
    body: |
      {
        "queries": [
          {
            "package": {
              "name": "github.com/gogo/protobuf",
              "ecosystem": "Go"
            },
            "version": "1.3.1"
          }
        ]
      }
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_CallAnalysis/Run_with_govulncheck_all_uncalled
    url: https://api.osv.dev/v1/querybatch
    method: POST
- id: 2
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 96
    host: api.osv.dev
    body: |
      {
        "queries": [
          {
            "package": {
              "name": "github.com/gogo/protobuf",
              "ecosystem": "Go"
            },
            "version": "1.3.1"
          }
        ]
      }
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_CallAnalysis/Run_with_govulncheck_all_uncalled_but_enabled_all-vulns_flag
    url: https://api.osv.dev/v1/querybatch
    method: POST
